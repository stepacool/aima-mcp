prompt: |
  You are an expert at designing and refining MCP server tools.

  You are given:
  1. A list of currently suggested tools for an MCP server.
  2. User feedback describing how these tools should be changed.
  3. Technical details (if provided) - API schemas, database schemas, endpoint specifications, etc.

  Your task is to REFINE the tools based on the feedback and technical details.

  IMPORTANT: If technical details are provided, you MUST use them to ensure tools match exact specifications:
  - Use the exact endpoint names, parameter names, and data structures from the technical details
  - Match parameter types and requirements to the technical specifications
  - Include all relevant parameters based on the technical details
  - Ensure tool names and descriptions accurately reflect the actual API/service capabilities described in the technical details
  - When refining based on user feedback, still maintain alignment with technical details

  GENERATING ADDITIONAL TECHNICAL DETAILS:
  - When refining tools, analyze the user feedback, existing tools, and any provided technical details
  - Generate ADDITIONAL technical details that would be helpful for implementing these tools accurately
  - Include comprehensive API specifications, endpoint details, request/response schemas, authentication requirements, error codes, rate limits, data models, database schemas, or any other technical information relevant to the tools
  - These additional technical details should complement and expand upon existing technical details
  - Focus on generating detailed, actionable technical specifications that would help developers implement the tools correctly
  - If you can infer technical details from the context (e.g., if tools suggest REST APIs, generate OpenAPI-like specifications; if tools suggest database operations, generate schema details), include them
  - Output these additional technical details in the "technical_details" field as an array of strings, where each string contains a comprehensive technical specification

  You may:
  - Modify existing tools (rename, change descriptions, adjust parameters) - but keep alignment with technical details
  - Add new tools if the feedback implies missing functionality - design them based on technical details when available
  - Remove tools that are unnecessary or incorrect

  IMPORTANT:
  - Output the COMPLETE, FINAL list of tools after refinement
  - Do NOT reference previous versions or say what changed
  - Assume the returned list will fully replace the existing tools
  - Follow the schema exactly
  - Prioritize technical details when they conflict with general descriptions

  For each tool specify:
  - name: pythonic snake_case function name (should match or be derived from the technical details when available)
  - description: what this tool does (should reference specific endpoints/operations from technical details when provided)
  - parameters: list of inputs needed (must align with the technical details - use exact parameter names, types, and requirements from the technical specifications)

  Each parameter must include:
  - name: exact name from technical details when available, otherwise use descriptive name
  - type: match the type from technical details (string, integer, boolean, etc.)
  - required: match the requirement from technical details (true/false)
  - description: describe what this parameter is for, referencing the technical details when applicable

  Output ONLY valid JSON matching this exact schema:

  {
    "tools": [
      {
        "name": "tool_name",
        "description": "What this tool does",
        "parameters": [
          {
            "name": "param_name",
            "type": "string",
            "required": true,
            "description": "What this parameter is for"
          }
        ]
      }
    ],
    "technical_details": [
      "Additional technical detail 1: Comprehensive API specification, endpoint details, schemas, etc.",
      "Additional technical detail 2: More technical specifications as needed"
    ]
  }

  Note: The "technical_details" field is optional. Include it when you can generate useful additional technical specifications that complement existing technical details. Each string in the array should be a comprehensive, detailed technical specification.

examples:
  - input: |
      Current tools:
      - list_repositories: List all repositories for the authenticated user
      - create_issue: Create a new issue in a GitHub repository

      User feedback:
      Add support for closing issues and make repository listing optionally filter by organization.
    output: |
      {
        "tools": [
          {
            "name": "list_repositories",
            "description": "List repositories accessible to the authenticated user",
            "parameters": [
              {
                "name": "organization",
                "type": "string",
                "required": false,
                "description": "Organization name to filter repositories"
              }
            ]
          },
          {
            "name": "create_issue",
            "description": "Create a new issue in a GitHub repository",
            "parameters": [
              {
                "name": "repository",
                "type": "string",
                "required": true,
                "description": "Repository name in owner/repo format"
              },
              {
                "name": "title",
                "type": "string",
                "required": true,
                "description": "Issue title"
              },
              {
                "name": "body",
                "type": "string",
                "required": false,
                "description": "Issue body or description"
              }
            ]
          },
          {
            "name": "close_issue",
            "description": "Close an existing issue in a GitHub repository",
            "parameters": [
              {
                "name": "repository",
                "type": "string",
                "required": true,
                "description": "Repository name in owner/repo format"
              },
              {
                "name": "issue_number",
                "type": "integer",
                "required": true,
                "description": "Number of the issue to close"
              }
            ]
          }
        ],
        "technical_details": [
          "GitHub API REST Endpoints:\n- GET /user/repos - List repositories for authenticated user. Query params: type (all, owner, member), sort (created, updated, pushed, full_name), direction (asc, desc), per_page (1-100), page (integer). Returns array of repository objects with fields: id, name, full_name, owner (object with login, id, type), private (boolean), html_url, description, fork (boolean), created_at, updated_at, pushed_at, git_url, ssh_url, clone_url, size, stargazers_count, watchers_count, language, default_branch.\n- POST /repos/{owner}/{repo}/issues - Create issue. Requires: title (string, required), body (string, optional), assignee (string, optional), milestone (integer, optional), labels (array of strings, optional), assignees (array of strings, optional). Returns issue object with number, state, title, body, user, labels, assignee, assignees, milestone, comments, created_at, updated_at, closed_at, pull_request (if issue is PR).\n- PATCH /repos/{owner}/{repo}/issues/{issue_number} - Update issue (can close by setting state to 'closed'). Requires: title, body, state (open, closed), assignee, milestone, labels, assignees. Returns updated issue object.\n- Authentication: Bearer token in Authorization header. Rate limit: 5000 requests/hour for authenticated requests."
        ]
      }

  - input: |
      Current tools:
      - get_current_weather: Get current weather conditions for a city

      User feedback:
      Support forecasts and allow specifying temperature units everywhere.
    output: |
      {
        "tools": [
          {
            "name": "get_current_weather",
            "description": "Get current weather conditions for a city",
            "parameters": [
              {
                "name": "city",
                "type": "string",
                "required": true,
                "description": "City name"
              },
              {
                "name": "units",
                "type": "string",
                "required": false,
                "description": "Temperature units (celsius or fahrenheit)"
              }
            ]
          },
          {
            "name": "get_weather_forecast",
            "description": "Get a weather forecast for the next few days",
            "parameters": [
              {
                "name": "city",
                "type": "string",
                "required": true,
                "description": "City name"
              },
              {
                "name": "days",
                "type": "integer",
                "required": true,
                "description": "Number of days to forecast"
              },
              {
                "name": "units",
                "type": "string",
                "required": false,
                "description": "Temperature units (celsius or fahrenheit)"
              }
            ]
          }
        ],
        "technical_details": [
          "Weather API REST Endpoints:\n- GET /current?city={city}&units={units} - Get current weather. Response: { temperature: float, condition: string, humidity: int, wind_speed: float, wind_direction: string, pressure: float, visibility: float, uv_index: int, feels_like: float, city: string, country: string, timezone: string, timestamp: ISO8601 }. Units: 'celsius' (default) or 'fahrenheit'. Temperature in selected units, wind_speed in km/h or mph based on units.\n- GET /forecast?city={city}&days={days}&units={units} - Get forecast. Response: { city: string, country: string, forecast: [ { date: YYYY-MM-DD, high: float, low: float, condition: string, precipitation_chance: int, wind_speed: float, humidity: int } ] }. Days: 1-10. Units same as current endpoint.\n- Error responses: 400 (invalid city/parameters), 401 (invalid API key), 404 (city not found), 429 (rate limit exceeded), 500 (server error). Rate limit: 1000 requests/day with free tier API key."
        ]
      }
