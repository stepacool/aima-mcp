<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoMCP - MCP Server Builder</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>AutoMCP</h1>
            <p class="subtitle">Build MCP servers through conversation</p>
        </header>

        <!-- Progress Steps -->
        <div class="progress-bar">
            <div class="step active" data-step="1">
                <div class="step-number">1</div>
                <div class="step-label">Describe</div>
            </div>
            <div class="step-connector"></div>
            <div class="step" data-step="2">
                <div class="step-number">2</div>
                <div class="step-label">Actions</div>
            </div>
            <div class="step-connector"></div>
            <div class="step" data-step="3">
                <div class="step-number">3</div>
                <div class="step-label">Auth</div>
            </div>
            <div class="step-connector"></div>
            <div class="step" data-step="4">
                <div class="step-number">4</div>
                <div class="step-label">Deploy</div>
            </div>
        </div>

        <main>
            <!-- Step 1: Describe System -->
            <section id="step-describe" class="wizard-step active">
                <h2>What should your MCP server do?</h2>
                <p class="step-desc">Describe the system or service you want to create. We'll suggest actions based on your description.</p>

                <textarea
                    id="system-description"
                    placeholder="Example: A server that manages my GitHub repositories - list repos, create issues, manage pull requests..."
                    rows="4"
                ></textarea>

                <button id="describe-btn" class="primary large">Generate Actions</button>
            </section>

            <!-- Step 2: Review Actions -->
            <section id="step-actions" class="wizard-step hidden">
                <div class="step-header">
                    <div>
                        <h2 id="server-name">MCP Server</h2>
                        <p class="step-desc" id="server-description"></p>
                    </div>
                </div>

                <div class="actions-list" id="actions-list">
                    <!-- Actions will be rendered here -->
                </div>

                <div class="refine-section">
                    <input type="text" id="refine-input" placeholder="Add more actions or modify existing ones...">
                    <button id="refine-btn" class="secondary">Refine</button>
                </div>

                <div class="step-actions">
                    <button id="back-to-describe" class="secondary">Back</button>
                    <button id="confirm-actions-btn" class="primary">Configure Auth</button>
                </div>
            </section>

            <!-- Step 3: Configure Auth -->
            <section id="step-auth" class="wizard-step hidden">
                <h2>Authentication Setup</h2>
                <p class="step-desc">How should actions that require authentication be handled?</p>

                <div class="auth-options">
                    <label class="auth-option" data-auth="none">
                        <input type="radio" name="auth-type" value="none" checked>
                        <div class="auth-option-content">
                            <strong>No Authentication</strong>
                            <span>Actions don't require auth or handle it internally</span>
                        </div>
                    </label>

                    <label class="auth-option" data-auth="ephemeral">
                        <input type="radio" name="auth-type" value="ephemeral">
                        <div class="auth-option-content">
                            <strong>Ephemeral Credentials</strong>
                            <span>Credentials passed at runtime (API keys, tokens)</span>
                        </div>
                    </label>

                    <label class="auth-option" data-auth="oauth">
                        <input type="radio" name="auth-type" value="oauth">
                        <div class="auth-option-content">
                            <strong>OAuth Integration</strong>
                            <span>Connect to your OAuth provider</span>
                        </div>
                    </label>
                </div>

                <div id="oauth-config" class="oauth-config hidden">
                    <input type="text" id="oauth-provider" placeholder="OAuth Provider URL">
                    <input type="text" id="oauth-client-id" placeholder="Client ID">
                    <input type="text" id="oauth-scopes" placeholder="Scopes (comma-separated)">
                </div>

                <div class="step-actions">
                    <button id="back-to-actions" class="secondary">Back</button>
                    <button id="confirm-auth-btn" class="primary">Review & Deploy</button>
                </div>
            </section>

            <!-- Step 4: Review & Deploy -->
            <section id="step-deploy" class="wizard-step hidden">
                <h2>Ready to Launch</h2>

                <div class="summary-card">
                    <h3 id="summary-name">Server Name</h3>
                    <p id="summary-description"></p>
                    <div class="summary-stats">
                        <div class="stat">
                            <span class="stat-value" id="summary-actions-count">0</span>
                            <span class="stat-label">Actions</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value" id="summary-auth-type">None</span>
                            <span class="stat-label">Auth Type</span>
                        </div>
                    </div>
                </div>

                <!-- Tier Selection -->
                <div class="tier-selection">
                    <h3>Choose Your Plan</h3>

                    <div class="tier-options">
                        <label class="tier-option selected" data-tier="free">
                            <input type="radio" name="tier" value="free" checked>
                            <div class="tier-content">
                                <div class="tier-header">
                                    <strong>Free</strong>
                                    <span class="tier-price">$0/mo</span>
                                </div>
                                <ul class="tier-features">
                                    <li>Up to 3 tools</li>
                                    <li>Curated libraries only</li>
                                    <li>Shared runtime</li>
                                    <li>Instant activation</li>
                                </ul>
                            </div>
                        </label>

                        <label class="tier-option" data-tier="paid">
                            <input type="radio" name="tier" value="paid">
                            <div class="tier-content">
                                <div class="tier-header">
                                    <strong>Pro</strong>
                                    <span class="tier-price">$29/mo</span>
                                </div>
                                <ul class="tier-features">
                                    <li>Unlimited tools</li>
                                    <li>Any libraries</li>
                                    <li>Own deployment</li>
                                    <li>Modal, Vercel, etc.</li>
                                </ul>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Free Tier: Curated Libraries Info -->
                <div id="free-tier-info" class="tier-info">
                    <h4>Allowed Libraries</h4>
                    <div class="library-tags" id="library-tags">
                        <span class="lib-tag">httpx</span>
                        <span class="lib-tag">asyncpg</span>
                        <span class="lib-tag">aiomysql</span>
                        <span class="lib-tag">gspread</span>
                        <span class="lib-tag">google-calendar</span>
                        <span class="lib-tag">json</span>
                        <span class="lib-tag">datetime</span>
                        <span class="lib-tag">pydantic</span>
                    </div>
                </div>

                <!-- Paid Tier: Deploy Options -->
                <div id="paid-tier-options" class="deploy-options hidden">
                    <h3>Select Deployment Target</h3>
                    <div class="deploy-targets">
                        <label class="deploy-target selected">
                            <input type="radio" name="deploy-target" value="standalone" checked>
                            <div class="target-content">
                                <strong>Standalone</strong>
                                <span>Run locally</span>
                            </div>
                        </label>
                        <label class="deploy-target">
                            <input type="radio" name="deploy-target" value="modal">
                            <div class="target-content">
                                <strong>Modal</strong>
                                <span>Serverless</span>
                            </div>
                        </label>
                        <label class="deploy-target">
                            <input type="radio" name="deploy-target" value="vercel">
                            <div class="target-content">
                                <strong>Vercel</strong>
                                <span>Edge</span>
                            </div>
                        </label>
                    </div>
                </div>

                <div class="step-actions">
                    <button id="back-to-auth" class="secondary">Back</button>
                    <button id="activate-btn" class="primary large">Activate (Free)</button>
                    <button id="deploy-btn" class="primary large hidden">Deploy (Pro)</button>
                </div>

                <!-- Code Preview (collapsed by default) -->
                <details class="code-preview">
                    <summary>View Generated Code</summary>
                    <pre><code id="code-content"></code></pre>
                </details>
            </section>

            <!-- Deployment Result -->
            <section id="step-result" class="wizard-step hidden">
                <h2>Deployment Package Ready</h2>
                <div id="deploy-instructions" class="instructions"></div>
                <div id="deploy-files" class="files-list"></div>
                <button id="start-over-btn" class="secondary">Create Another Server</button>
            </section>
        </main>

        <div id="loading" class="loading hidden">
            <div class="spinner"></div>
            <p id="loading-text">Processing...</p>
        </div>
    </div>

    <script src="api-client.js"></script>
    <script src="app.js"></script>
</body>
</html>
